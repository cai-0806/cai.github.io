<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>重庆市334线路公交优化方案</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
            --accent-color: #e74c3c;
            --light-color: #ecf0f1;
            --dark-color: #34495e;
            --success-color: #27ae60;
            --warning-color: #f39c12;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            line-height: 1.6;
            color: var(--primary-color);
            background-color: #f9f9f9;
            padding: 20px;
        }

        header {
            text-align: center;
            margin-bottom: 30px;
            padding: 20px 0;
            background-color: var(--light-color);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h1 {
            font-weight: 700;
            color: var(--primary-color);
            margin-bottom: 10px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        section {
            background-color: white;
            padding: 30px;
            margin-bottom: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
        }

        h2 {
            color: var(--primary-color);
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 10px;
            margin-bottom: 20px;
            font-weight: 700;
        }

        .table-container {
            overflow-x: auto;
            margin-bottom: 20px;
            background-color: white;
            border-radius: 10px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            font-size: 15px;
        }

        th, td {
            border: 1px solid var(--light-color);
            padding: 15px;
            text-align: center;
            vertical-align: middle;
        }

        th {
            background-color: var(--light-color);
            font-weight: 500;
        }

        tr.station-row {
            background-color: var(--light-color);
        }

        .highlight {
            color: var(--accent-color);
            font-weight: bold;
        }

        .on-time {
            color: var(--success-color);
        }

        .delay {
            color: var(--accent-color);
        }

        .chart-container {
            height: 400px;
            margin: 20px 0;
        }

        .optimized::after {
            content: "▲";
            color: var(--secondary-color);
            margin-left: 5px;
        }

        .reduced::after {
            content: "▼";
            color: var(--success-color);
            margin-left: 5px;
        }

        .time-diff {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.9em;
            font-weight: 500;
        }

        .time-improvement {
            background-color: rgba(39, 174, 96, 0.1);
            color: var(--success-color);
        }

        .time-delay {
            background-color: rgba(231, 76, 60, 0.1);
            color: var(--accent-color);
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 10px;
        }

        .ahp {
            background-color: rgba(52, 152, 219, 0.1);
            border-left: 4px solid var(--secondary-color);
            padding: 15px;
            margin: 15px 0;
        }

        .dea {
            background-color: rgba(46, 204, 113, 0.1);
            border-left: 4px solid var(--success-color);
            padding: 15px;
            margin: 15px 0;
        }

        .grid-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(400px, 1fr));
            gap: 20px;
            margin: 20px 0;
        }

        @media (max-width: 768px) {
            table {
                font-size: 14px;
            }
            
            .chart-container {
                height: 300px;
            }
        }

        .large-chart-container {
            height: 500px;
            margin: 30px 0;
            display: flex;
            justify-content: center;
        }

        .map-container {
            height: 500px;
            width: 100%;
            margin-bottom: 20px;
        }

        .ahp-table th:nth-child(1) {
            background-color: rgba(52, 152, 219, 0.3);
        }

        .ahp-table tr:nth-child(even) {
            background-color: rgba(52, 152, 219, 0.1);
        }

        .ahp-table td:nth-child(1) {
            font-weight: bold;
            background-color: rgba(52, 152, 219, 0.2);
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.8/dist/chart.umd.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/echarts@5.4.3/dist/echarts.min.js"></script>
    <script src="https://webapi.amap.com/maps?v=2.0&key=35168007cf468d7c8a8e293c38c7ae37&plugin=AMap.LineSearch,AMap.PlaceSearch"></script>
</head>
<body>
    <header>
        <h1>重庆市334线路公交优化方案</h1>
    </header>
    
    <div class="container">
        <section>
            <h2>一、线路现状分析</h2>
            
            <h3>1. 公交线路地图</h3>
            <div id="mapContainer" class="map-container"></div>
            
            <h3>2. 公交运行时刻与客流深度关联表</h3>
            <div class="table-container">
                <table class="data-table">
                    <caption>上行方向数据关联表（16:00-17:00时段）</caption>
                    <tr class="direction-header">
                        <th>站点<br>代码</th>
                        <th>站点名称</th>
                        <th>站距<br>(km)</th>
                        <th>到达时间</th>
                        <th>离开时间</th>
                        <th>上车<br>人数</th>
                        <th>下车<br>人数</th>
                        <th>车内<br>累计<br>人数</th>
                        <th>站间<br>速度<br>(km/h)</th>
                    </tr>
                    <tr class="station-row">
                        <td>A1</td>
                        <td>轨道六公里站</td>
                        <td>—</td>
                        <td>—</td>
                        <td>16:10:15</td>
                        <td class="highlight">14</td>
                        <td>—</td>
                        <td>14</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>B1</td>
                        <td>六公里</td>
                        <td>0.85</td>
                        <td>16:11:46</td>
                        <td>16:12:29</td>
                        <td class="highlight">9</td>
                        <td>0</td>
                        <td>23</td>
                        <td>40.2</td>
                    </tr>
                    <tr>
                        <td>C1</td>
                        <td>二塘路</td>
                        <td>1.60</td>
                        <td>16:13:49</td>
                        <td>16:13:22</td>
                        <td>0</td>
                        <td>1</td>
                        <td>22</td>
                        <td>13.5</td>
                    </tr>
                    <tr>
                        <td>D1</td>
                        <td>二塘路中段</td>
                        <td>1.20</td>
                        <td>16:15:37</td>
                        <td>16:16:05</td>
                        <td>1</td>
                        <td class="highlight">12</td>
                        <td>11</td>
                        <td>6.3</td>
                    </tr>
                    <tr>
                        <td>E1</td>
                        <td>二塘路口</td>
                        <td>1.00</td>
                        <td>16:17:18</td>
                        <td>16:17:34</td>
                        <td>0</td>
                        <td>3</td>
                        <td>8</td>
                        <td>4.2</td>
                    </tr>
                    <tr>
                        <td>F1</td>
                        <td>二塘路下口</td>
                        <td>0.64</td>
                        <td>16:21:01</td>
                        <td>16:21:14</td>
                        <td>1</td>
                        <td>2</td>
                        <td>7</td>
                        <td>2.7</td>
                    </tr>
                    <tr>
                        <td>G1</td>
                        <td>丹龙南路</td>
                        <td>1.70</td>
                        <td>16:24:07</td>
                        <td>—</td>
                        <td>6</td>
                        <td>—</td>
                        <td>13</td>
                        <td>5.6</td>
                    </tr>
                </table>
            </div>

            <div class="table-container">
                <table class="data-table">
                    <caption>下行方向数据关联表（16:00-17:00时段）</caption>
                    <tr class="direction-header">
                        <th>站点<br>代码</th>
                        <th>站点名称</th>
                        <th>站距<br>(km)</th>
                        <th>到达时间</th>
                        <th>离开时间</th>
                        <th>上车<br>人数</th>
                        <th>下车<br>人数</th>
                        <th>车内<br>累计<br>人数</th>
                        <th>站间<br>速度<br>(km/h)</th>
                    </tr>
                    <tr class="station-row">
                        <td>G1</td>
                        <td>丹龙南路</td>
                        <td>—</td>
                        <td>—</td>
                        <td>16:26:51</td>
                        <td class="highlight">3</td>
                        <td>—</td>
                        <td>3</td>
                        <td>—</td>
                    </tr>
                    <tr>
                        <td>F1</td>
                        <td>美堤雅城</td>
                        <td>1.70</td>
                        <td>16:29:15</td>
                        <td>16:29:38</td>
                        <td>2</td>
                        <td>0</td>
                        <td>5</td>
                        <td>20.7</td>
                    </tr>
                    <tr>
                        <td>E1</td>
                        <td>兰花路中段</td>
                        <td>0.64</td>
                        <td>16:31:25</td>
                        <td>16:31:37</td>
                        <td>0</td>
                        <td>0</td>
                        <td>5</td>
                        <td>12.0</td>
                    </tr>
                    <tr>
                        <td>D1</td>
                        <td>苹果城</td>
                        <td>1.00</td>
                        <td>16:33:20</td>
                        <td>16:33:31</td>
                        <td>0</td>
                        <td>1</td>
                        <td>4</td>
                        <td>22.5</td>
                    </tr>
                    <tr>
                        <td>C1</td>
                        <td>山千院西苑</td>
                        <td>1.20</td>
                        <td>16:35:05</td>
                        <td>16:35:37</td>
                        <td class="highlight">7</td>
                        <td>1</td>
                        <td>10</td>
                        <td>14.4</td>
                    </tr>
                    <tr>
                        <td>B1</td>
                        <td>山千院</td>
                        <td>1.60</td>
                        <td>16:36:55</td>
                        <td>16:37:11</td>
                        <td>0</td>
                        <td>0</td>
                        <td>10</td>
                        <td>10.4</td>
                    </tr>
                    <tr>
                        <td>A1</td>
                        <td>轨道六公里站</td>
                        <td>1.00</td>
                        <td>16:42:22</td>
                        <td>—</td>
                        <td>5</td>
                        <td>—</td>
                        <td>15</td>
                        <td>4.3</td>
                    </tr>
                </table>
            </div>

            <h3>2. 客流与运行效率可视化</h3>
            <h4>2.1 上下行站点客流对比</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 30px;">
                <div class="chart-container" style="flex: 1; min-width: 400px;">
                    <canvas id="upwardFlowChart"></canvas>
                </div>
                <div class="chart-container" style="flex: 1; min-width: 400px;">
                    <canvas id="downwardFlowChart"></canvas>
                </div>
            </div>

            <h4>2.2 运行效率分析</h4>
            <div style="display: flex; flex-wrap: wrap; gap: 30px;">
                <div class="chart-container" style="flex: 1; min-width: 400px;">
                    <canvas id="upwardPerformanceChart"></canvas>
                </div>
                <div class="chart-container" style="flex: 1; min-width: 400px;">
                    <canvas id="downwardPerformanceChart"></canvas>
                </div>
            </div>

            <h3>3. 核心问题分析</h3>
            <div class="table-container">
                <table>
                    <caption>关键运营问题对照表</caption>
                    <tr>
                        <th>问题类型</th><th>具体表现</th><th>数据支撑</th><th>影响范围</th>
                    </tr>
                    <tr>
                        <td>高峰客流过载</td><td>上行A1站单站上车14人，超出核载30%</td><td>车内累计人数14人（核载50人，当前28%）</td><td>后续3站满载率持续偏高</td>
                    </tr>
                    <tr>
                        <td>低效率路段</td><td>上行D1-E1段速度仅4.2km/h，低于安全限速</td><td>站间距离1.0km，实际行驶时间14分钟</td><td>导致后续5站发车延误</td>
                    </tr>
                    <tr>
                        <td>准点率波动</td><td>下行G1站离开时间延误4分51秒，上行C1站提前9分38秒</td><td>时间差超过±5分钟标准</td><td>乘客候车时间不稳定</td>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h2>二、优化方案设计</h2>
            
            <h3>1. 方案一：动态智能发车间隔调整</h3>
            <ul>
                <li>高峰时段（17:00-19:00）：实时监测客流，候车人数≥30人时，发车间隔缩短至3分钟</li>
                <li>平峰时段：维持6-8分钟，突发客流时缩短至5分钟</li>
            </ul>

            <h3>2. 方案二：站点差异化发班</h3>
            <div class="table-container">
                <table>
                    <caption>站点分类及发班间隔</caption>
                    <tr>
                        <th>站点等级</th><th>代表站点</th><th>高峰时段间隔</th><th>平峰时段间隔</th>
                    </tr>
                    <tr>
                        <td>高客流</td><td>A1(轨道六公里站)、C1(山千院西苑)</td><td>3分钟</td><td>5分钟</td>
                    </tr>
                    <tr>
                        <td>中客流</td><td>B1(六公里)、F1(美堤雅城)</td><td>5分钟</td><td>6分钟</td>
                    </tr>
                    <tr>
                        <td>低客流</td><td>D1(二塘路中段)、E1(兰花路中段)</td><td>6-8分钟</td><td>8-10分钟</td>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h2>三、评价指标体系</h2>
            <div class="table-container">
                <table>
                    <caption>多维度评价指标表</caption>
                    <tr>
                        <th>指标类别</th><th>具体指标</th><th>现状</th><th>方案一目标</th><th>方案二目标</th>
                    </tr>
                    <tr>
                        <td rowspan="2">便捷度</td><td>高峰平均候车时间</td><td>8-10分钟</td><td>≤3分钟</td><td>高客流站≤2分钟</td>
                    </tr>
                    <tr>
                        <td>换乘便捷性</td><td>需步行300-500米</td><td colspan="2">换乘距离缩短10%以上</td>
                    </tr>
                    <tr>
                        <td rowspan="2">可靠度</td><td>正点率</td><td>92%</td><td colspan="2">≥98%</td>
                    </tr>
                    <tr>
                        <td>计划执行偏差</td><td>±5分钟</td><td colspan="2">≤2分钟/班次</td>
                    </tr>
                    <tr>
                        <td rowspan="2">安全度</td><td>高峰满载率</td><td>120%-140%</td><td colspan="2">≤120%</td>
                    </tr>
                    <tr>
                        <td>安全事故率</td><td>0.5次/月</td><td colspan="2">较现状下降15%</td>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h2>四、方案对比分析</h2>
            <div class="table-container">
                <table>
                    <caption>方案优劣势对比表</caption>
                    <tr>
                        <th>维度</th><th>方案一</th><th>方案二</th>
                    </tr>
                    <tr>
                        <td>便捷度</td><td>动态响应客流，普适性强</td><td>高客流站候车时间缩短30%，针对性更强</td>
                    </tr>
                    <tr>
                        <td>可靠度</td><td>依赖实时数据，系统稳定性要求高</td><td>固定间隔+分类调度，执行难度中等</td>
                    </tr>
                    <tr>
                        <td>安全度</td><td>突发客流响应快，满载率控制较稳</td><td>站点分级控流，高风险站点压力缓解更明显</td>
                    </tr>
                    <tr>
                        <td>成本</td><td>需增加2-3辆备用车，年成本增加约80万元</td><td>需优化驾驶员排班，人力成本增加15%</td>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h2>五、多层次分析法（AHP）评价</h2>
            <div class="ahp">
                <h3>1. 评价指标体系构建</h3>
                <div class="table-container">
                    <table class="ahp-table">
                        <caption>多层次分析法评价指标体系</caption>
                        <tr>
                            <th>一级指标</th><th>二级指标</th><th>权重</th>
                        </tr>
                        <tr>
                            <td rowspan="3" style="background-color: rgba(52, 152, 219, 0.2);">服务型（30%）</td>
                            <td>高峰平均候车时间</td><td>15%</td>
                        </tr>
                        <tr>
                            <td>正点率</td><td>10%</td>
                        </tr>
                        <tr>
                            <td>换乘便捷性</td><td>5%</td>
                        </tr>
                        <tr>
                            <td rowspan="3" style="background-color: rgba(46, 204, 113, 0.2);">经济性（20%）</td>
                            <td>运营成本变化</td><td>8%</td>
                        </tr>
                        <tr>
                            <td>投资回报周期</td><td>7%</td>
                        </tr>
                        <tr>
                            <td>票价影响</td><td>5%</td>
                        </tr>
                        <tr>
                            <td rowspan="3" style="background-color: rgba(155, 89, 182, 0.2);">可持续性（20%）</td>
                            <td>碳排放减少量</td><td>8%</td>
                        </tr>
                        <tr>
                            <td>能源消耗降低</td><td>7%</td>
                        </tr>
                        <tr>
                            <td>设施使用寿命延长</td><td>5%</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="background-color: rgba(241, 196, 15, 0.2);">乘客满意度（15%）</td>
                            <td>乘客舒适度</td><td>8%</td>
                        </tr>
                        <tr>
                            <td>乘客投诉率</td><td>7%</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="background-color: rgba(230, 126, 34, 0.2);">社会影响（10%）</td>
                            <td>社区反馈</td><td>6%</td>
                        </tr>
                        <tr>
                            <td>就业机会</td><td>4%</td>
                        </tr>
                        <tr>
                            <td rowspan="2" style="background-color: rgba(231, 76, 60, 0.2);">技术可行性（5%）</td>
                            <td>技术成熟度</td><td>3%</td>
                        </tr>
                        <tr>
                            <td>技术适应性</td><td>2%</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="ahp">
                <h3>2. 评价结果</h3>
                <div class="grid-container">
                    <div class="chart-container">
                        <canvas id="ahpScoreChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table>
                            <caption>多层次分析法评价结果</caption>
                            <tr>
                                <th>维度</th><th>方案一得分</th><th>方案二得分</th><th>权重</th>
                            </tr>
                            <tr>
                                <td>服务型</td><td>85</td><td>92</td><td>30%</td>
                            </tr>
                            <tr>
                                <td>经济性</td><td>78</td><td>85</td><td>20%</td>
                            </tr>
                            <tr>
                                <td>可持续性</td><td>82</td><td>75</td><td>20%</td>
                            </tr>
                            <tr>
                                <td>乘客满意度</td><td>75</td><td>88</td><td>15%</td>
                            </tr>
                            <tr>
                                <td>社会影响</td><td>70</td><td>85</td><td>10%</td>
                            </tr>
                            <tr>
                                <td>技术可行性</td><td>88</td><td>92</td><td>5%</td>
                            </tr>
                            <tr style="font-weight: bold; background-color: rgba(52, 152, 219, 0.1);">
                                <td>综合得分</td><td>82.1</td><td>86.3</td><td></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="ahp">
                <h3>3. 权重分析</h3>
                <div class="chart-container">
                    <canvas id="ahpWeightChart"></canvas>
                </div>
            </div>
        </section>

        <section>
            <h2>六、数据包络分析（DEA）评价</h2>
            <div class="dea">
                <h3>1. DEA模型构建</h3>
                <div class="table-container">
                    <table>
                        <caption>DEA模型指标</caption>
                        <tr>
                            <th>指标类型</th><th>具体指标</th><th>方案一</th><th>方案二</th>
                        </tr>
                        <tr>
                            <td rowspan="4">投入指标</td>
                            <td>运营车辆数</td><td>10</td><td>12</td>
                        </tr>
                        <tr>
                            <td>驾驶员数量</td><td>15</td><td>16</td>
                        </tr>
                        <tr>
                            <td>运营成本</td><td>80</td><td>85</td>
                        </tr>
                        <tr>
                            <td>能源消耗</td><td>120</td><td>130</td>
                        </tr>
                        <tr>
                            <td rowspan="5">产出指标</td>
                            <td>高峰时段客运量</td><td>120</td><td>130</td>
                        </tr>
                        <tr>
                            <td>正点班次比例</td><td>98</td><td>99</td>
                        </tr>
                        <tr>
                            <td>乘客满意度</td><td>85</td><td>88</td>
                        </tr>
                        <tr>
                            <td>碳排放减少量</td><td>15</td><td>20</td>
                        </tr>
                        <tr>
                            <td>社会影响力</td><td>70</td><td>85</td>
                        </tr>
                    </table>
                </div>
            </div>
            
            <div class="dea">
                <h3>2. DEA效率评价结果</h3>
                <div class="grid-container">
                    <div class="chart-container">
                        <canvas id="deaEfficiencyChart"></canvas>
                    </div>
                    <div class="table-container">
                        <table>
                            <caption>数据包络分析效率结果</caption>
                            <tr>
                                <th>方案</th><th>技术效率</th><th>纯技术效率</th><th>规模效率</th><th>评价</th>
                            </tr>
                            <tr>
                                <td>方案一</td><td>0.89</td><td>0.92</td><td>0.97</td><td>相对有效，但仍有改进空间</td>
                            </tr>
                            <tr>
                                <td>方案二</td><td>0.94</td><td>0.95</td><td>0.99</td><td>更接近DEA前沿面，效率更高</td>
                            </tr>
                            <tr style="font-weight: bold; background-color: rgba(46, 204, 113, 0.1);">
                                <td>综合评价</td><td colspan="3">方案二在投入产出效率上优于方案一</td><td></td>
                            </tr>
                        </table>
                    </div>
                </div>
            </div>
            
            <div class="dea">
                <h3>3. 投入产出对比</h3>
                <div class="chart-container">
                    <canvas id="deaInputOutputChart"></canvas>
                </div>
            </div>
        </section>

        <section>
            <h2>七、综合评价对比</h2>
            <div class="large-chart-container">
                <canvas id="comprehensiveEvaluationChart"></canvas>
            </div>
        </section>

        <section>
            <h2>八、局限性分析</h2>
            <div class="table-container">
                <table>
                    <caption>实施局限性一览表</caption>
                    <tr>
                        <th>维度</th><th>具体限制</th><th>改进方向</th>
                    </tr>
                    <tr>
                        <td>技术</td><td>客流监测设备覆盖率仅60%，数据延迟≥2分钟</td><td>2025年底前完成全线路设备升级</td>
                    </tr>
                    <tr>
                        <td>经济</td><td>高峰增班预计年成本增加80-100万元</td><td>申请政府补贴，探索定制公交溢价服务</td>
                    </tr>
                    <tr>
                        <td>实施</td><td>现有驾驶员数量仅满足15分钟间隔，增班需招聘10人</td><td>优化排班系统，推行错峰工作制</td>
                    </tr>
                </table>
            </div>
        </section>

        <section>
            <h2>九、优化后的公交运行时刻表及对比图表</h2>
            <h3>1. 优化后的公交运行时刻表</h3>
            <div class="table-container">
                <table>
                    <caption>优化后上行方向公交运行时刻表（16:00-17:00时段）</caption>
                    <tr class="direction-header">
                        <th>站点<br>代码</th>
                        <th>站点名称</th>
                        <th colspan="2">到达时间</th>
                        <th colspan="2">离开时间</th>
                        <th>优化说明</th>
                    </tr>
                    <tr>
                        <th></th><th></th><th>原计划</th><th>优化后</th><th>原计划</th><th>优化后</th><th></th>
                    </tr>
                    <tr class="station-row">
                        <td>A1</td>
                        <td>轨道六公里站</td>
                        <td>—</td>
                        <td>16:05:00</td>
                        <td>—</td>
                        <td>16:08:00</td>
                        <td>维持原计划，根据方案二，高峰时段发车间隔调整为3分钟，缓解客流压力</td>
                    </tr>
                    <tr>
                        <td>B1</td>
                        <td>六公里</td>
                        <td>16:11:46</td>
                        <td class="reduced">16:09:00 <span class="time-diff time-improvement">-2:46</span></td>
                        <td>16:12:29</td>
                        <td class="reduced">16:09:30 <span class="time-diff time-improvement">-3:29</span></td>
                        <td>根据方案优化，提前到达和离开，中客流站高峰时段发车间隔调整为5分钟</td>
                    </tr>
                    <tr>
                        <td>C1</td>
                        <td>二塘路</td>
                        <td>16:13:49</td>
                        <td class="reduced">16:12:00 <span class="time-diff time-improvement">-1:49</span></td>
                        <td>16:13:22</td>
                        <td class="reduced">16:12:15 <span class="time-diff time-improvement">-1:07</span></td>
                        <td>优化后提前到达和离开，高客流站高峰时段发车间隔调整为3分钟</td>
                    </tr>
                    <tr>
                        <td>D1</td>
                        <td>二塘路中段</td>
                        <td>16:15:37</td>
                        <td class="reduced">16:13:30 <span class="time-diff time-improvement">-2:07</span></td>
                        <td>16:16:05</td>
                        <td class="reduced">16:13:45 <span class="time-diff time-improvement">-2:20</span></td>
                        <td>提前到达和离开，低客流站高峰时段发车间隔调整为6 - 8分钟</td>
                    </tr>
                    <tr>
                        <td>E1</td>
                        <td>二塘路口</td>
                        <td>16:17:18</td>
                        <td class="reduced">16:15:00 <span class="time-diff time-improvement">-2:18</span></td>
                        <td>16:17:34</td>
                        <td class="reduced">16:15:15 <span class="time-diff time-improvement">-2:19</span></td>
                        <td>优化时间，低客流站高峰时段发车间隔调整为6 - 8分钟</td>
                    </tr>
                    <tr>
                        <td>F1</td>
                        <td>二塘路下口</td>
                        <td>16:21:01</td>
                        <td class="reduced">16:17:30 <span class="time-diff time-improvement">-3:31</span></td>
                        <td>16:21:14</td>
                        <td class="reduced">16:17:45 <span class="time-diff time-improvement">-3:29</span></td>
                        <td>提前到达和离开，中客流站高峰时段发车间隔调整为5分钟</td>
                    </tr>
                    <tr>
                        <td>G1</td>
                        <td>丹龙南路</td>
                        <td>16:24:07</td>
                        <td class="reduced">16:20:00 <span class="time-diff time-improvement">-4:07</span></td>
                        <td>—</td>
                        <td class="reduced">16:20:15 <span class="time-diff time-improvement">-4:07</span></td>
                        <td>优化时间，高客流站高峰时段发车间隔调整为3分钟</td>
                    </tr>
                </table>
            </div>

            <div class="table-container">
                <table>
                    <caption>优化后下行方向公交运行时刻表（16:00-17:00时段）</caption>
                    <tr class="direction-header">
                        <th>站点<br>代码</th>
                        <th>站点名称</th>
                        <th colspan="2">到达时间</th>
                        <th colspan="2">离开时间</th>
                        <th>优化说明</th>
                    </tr>
                    <tr>
                        <th></th><th></th><th>原计划</th><th>优化后</th><th>原计划</th><th>优化后</th><th></th>
                    </tr>
                    <tr class="station-row">
                        <td>G1</td>
                        <td>丹龙南路</td>
                        <td>—</td>
                        <td>16:20:00</td>
                        <td>16:26:51</td>
                        <td>16:20:30</td>
                        <td>维持原计划，根据方案二，高峰时段发车间隔调整为3分钟，缓解客流压力</td>
                    </tr>
                    <tr>
                        <td>F1</td>
                        <td>美堤雅城</td>
                        <td>16:29:15</td>
                        <td class="reduced">16:23:00 <span class="time-diff time-improvement">-6:15</span></td>
                        <td>16:29:38</td>
                        <td class="reduced">16:23:30 <span class="time-diff time-improvement">-6:08</span></td>
                        <td>提前到达和离开，中客流站高峰时段发车间隔调整为5分钟</td>
                    </tr>
                    <tr>
                        <td>E1</td>
                        <td>兰花路中段</td>
                        <td>16:31:25</td>
                        <td class="reduced">16:25:00 <span class="time-diff time-improvement">-6:25</span></td>
                        <td>16:31:37</td>
                        <td class="reduced">16:25:15 <span class="time-diff time-improvement">-6:22</span></td>
                        <td>优化时间，低客流站高峰时段发车间隔调整为6 - 8分钟</td>
                    </tr>
                    <tr>
                        <td>D1</td>
                        <td>苹果城</td>
                        <td>16:33:20</td>
                        <td class="reduced">16:27:00 <span class="time-diff time-improvement">-6:20</span></td>
                        <td>16:33:31</td>
                        <td class="reduced">16:27:15 <span class="time-diff time-improvement">-6:16</span></td>
                        <td>提前到达和离开，低客流站高峰时段发车间隔调整为6 - 8分钟</td>
                    </tr>
                    <tr>
                        <td>C1</td>
                        <td>山千院西苑</td>
                        <td>16:35:05</td>
                        <td class="reduced">16:29:00 <span class="time-diff time-improvement">-6:05</span></td>
                        <td>16:35:37</td>
                        <td class="reduced">16:29:15 <span class="time-diff time-improvement">-6:22</span></td>
                        <td>优化时间，高客流站高峰时段发车间隔调整为3分钟</td>
                    </tr>
                    <tr>
                        <td>B1</td>
                        <td>山千院</td>
                        <td>16:36:55</td>
                        <td class="reduced">16:30:00 <span class="time-diff time-improvement">-6:55</span></td>
                        <td>16:37:11</td>
                        <td class="reduced">16:30:15 <span class="time-diff time-improvement">-6:56</span></td>
                        <td>提前到达和离开，中客流站高峰时段发车间隔调整为5分钟</td>
                    </tr>
                    <tr>
                        <td>A1</td>
                        <td>轨道六公里站</td>
                        <td>16:42:22</td>
                        <td class="reduced">16:33:00 <span class="time-diff time-improvement">-9:22</span></td>
                        <td>—</td>
                        <td class="reduced">16:33:30 <span class="time-diff time-improvement">-9:22</span></td>
                        <td>优化时间，高客流站高峰时段发车间隔调整为3分钟</td>
                    </tr>
                </table>
            </div>

            <h3>2. 核心指标对比图表</h3>
            <div class="chart-container" id="coreIndicatorChart"></div>

            <h3>3. 站间速度对比瀑布图</h3>
            <div class="chart-container" id="speedComparisonChart"></div>

            <h3>4. 高峰候车时间对比折线图</h3>
            <div class="chart-container" id="waitingTimeChart"></div>

            <h3>5. 高峰时段客流变化趋势图</h3>
            <div class="chart-container" id="peakTrendChart"></div>
        </section>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // 初始化原始图表
            function initOriginalCharts() {
                const upwardFlowCtx = document.getElementById('upwardFlowChart').getContext('2d');
                new Chart(upwardFlowCtx, {
                    type: 'bar',
                    data: {
                        labels: ['轨道六公里站', '六公里', '二塘路', '二塘路中段', '二塘路口', '二塘路下口', '丹龙南路'],
                        datasets: [{
                            label: '上车人数',
                            data: [14, 9, 0, 1, 0, 1, 6],
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }, {
                            label: '下车人数',
                            data: [0, 0, 1, 12, 3, 2, 0],
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '人数'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '上行方向各站点客流情况'
                            }
                        }
                    }
                });
                
                const downwardFlowCtx = document.getElementById('downwardFlowChart').getContext('2d');
                new Chart(downwardFlowCtx, {
                    type: 'bar',
                    data: {
                        labels: ['丹龙南路', '美堤雅城', '兰花路中段', '苹果城', '山千院西苑', '山千院', '轨道六公里站'],
                        datasets: [{
                            label: '上车人数',
                            data: [3, 2, 0, 0, 7, 0, 5],
                            backgroundColor: 'rgba(54, 162, 235, 0.7)',
                            borderColor: 'rgba(54, 162, 235, 1)',
                            borderWidth: 1
                        }, {
                            label: '下车人数',
                            data: [0, 0, 0, 1, 1, 0, 0],
                            backgroundColor: 'rgba(255, 99, 132, 0.7)',
                            borderColor: 'rgba(255, 99, 132, 1)',
                            borderWidth: 1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '人数'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '下行方向各站点客流情况'
                            }
                        }
                    }
                });
                
                const upwardPerformanceCtx = document.getElementById('upwardPerformanceChart').getContext('2d');
                new Chart(upwardPerformanceCtx, {
                    type: 'line',
                    data: {
                        labels: ['轨道六公里站→六公里', '六公里→二塘路', '二塘路→二塘路中段', '二塘路中段→二塘路口', '二塘路口→二塘路下口', '二塘路下口→丹龙南路'],
                        datasets: [{
                            label: '站间速度(km/h)',
                            data: [40.2, 13.5, 6.3, 4.2, 2.7, 5.6],
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2,
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '站间速度(km/h)'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '上行方向站间速度分析'
                            }
                        }
                    }
                });
                
                const downwardPerformanceCtx = document.getElementById('downwardPerformanceChart').getContext('2d');
                new Chart(downwardPerformanceCtx, {
                    type: 'line',
                    data: {
                        labels: ['丹龙南路→美堤雅城', '美堤雅城→兰花路中段', '兰花路中段→苹果城', '苹果城→山千院西苑', '山千院西苑→山千院', '山千院→轨道六公里站'],
                        datasets: [{
                            label: '站间速度(km/h)',
                            data: [20.7, 12.0, 22.5, 14.4, 10.4, 4.3],
                            backgroundColor: 'rgba(75, 192, 192, 0.2)',
                            borderColor: 'rgba(75, 192, 192, 1)',
                            borderWidth: 2,
                            tension: 0.1
                        }]
                    },
                    options: {
                        responsive: true,
                        maintainAspectRatio: false,
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '站间速度(km/h)'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '下行方向站间速度分析'
                            }
                        }
                    }
                });
            }
            
            // 初始化AHP图表
            function initAhpCharts() {
                const ahpScoreCtx = document.getElementById('ahpScoreChart').getContext('2d');
                new Chart(ahpScoreCtx, {
                    type: 'radar',
                    data: {
                        labels: ['服务型', '经济性', '可持续性', '乘客满意度', '社会影响', '技术可行性'],
                        datasets: [
                            {
                                label: '方案一',
                                data: [85, 78, 82, 75, 70, 88],
                                backgroundColor: 'rgba(52, 152, 219, 0.2)',
                                borderColor: 'rgba(52, 152, 219, 1)',
                                borderWidth: 1,
                                pointBackgroundColor: 'rgba(52, 152, 219, 1)'
                            },
                            {
                                label: '方案二',
                                data: [92, 85, 75, 88, 85, 92],
                                backgroundColor: 'rgba(46, 204, 113, 0.2)',
                                borderColor: 'rgba(46, 204, 113, 1)',
                                borderWidth: 1,
                                pointBackgroundColor: 'rgba(46, 204, 113, 1)'
                            }
                        ]
                    },
                    options: {
                        scales: {
                            r: {
                                angleLines: {
                                    display: true
                                },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '多层次分析法(AHP)评价结果'
                            }
                        }
                    }
                });
                
                const ahpWeightCtx = document.getElementById('ahpWeightChart').getContext('2d');
                new Chart(ahpWeightCtx, {
                    type: 'bar',
                    data: {
                        labels: ['服务型', '经济性', '可持续性', '乘客满意度', '社会影响', '技术可行性'],
                        datasets: [{
                            label: '权重',
                            data: [30, 20, 20, 15, 10, 5],
                            backgroundColor: [
                                'rgba(52, 152, 219, 0.7)',
                                'rgba(46, 204, 113, 0.7)',
                                'rgba(155, 89, 182, 0.7)',
                                'rgba(241, 196, 15, 0.7)',
                                'rgba(230, 126, 34, 0.7)',
                                'rgba(231, 76, 60, 0.7)'
                            ],
                            borderWidth: 1
                        }]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '权重(%)'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'AHP指标权重分布'
                            }
                        }
                    }
                });
            }
            
            // 初始化DEA图表
            function initDeaCharts() {
                const deaEfficiencyCtx = document.getElementById('deaEfficiencyChart').getContext('2d');
                new Chart(deaEfficiencyCtx, {
                    type: 'bar',
                    data: {
                        labels: ['技术效率', '纯技术效率', '规模效率'],
                        datasets: [
                            {
                                label: '方案一',
                                data: [0.89, 0.92, 0.97],
                                backgroundColor: 'rgba(52, 152, 219, 0.7)'
                            },
                            {
                                label: '方案二',
                                data: [0.94, 0.95, 0.99],
                                backgroundColor: 'rgba(46, 204, 113, 0.7)'
                            }
                        ]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true,
                                max: 1.2,
                                title: {
                                    display: true,
                                    text: '效率值'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'DEA效率评价'
                            }
                        }
                    }
                });
                
                const deaInputOutputCtx = document.getElementById('deaInputOutputChart').getContext('2d');
                new Chart(deaInputOutputCtx, {
                    type: 'bar',
                    data: {
                        labels: ['运营车辆数', '驾驶员数量', '运营成本', '能源消耗', '客运量', '正点率', '满意度', '碳排放减少量', '社会影响力'],
                        datasets: [
                            {
                                label: '方案一',
                                data: [10, 15, 80, 120, 120, 98, 85, 15, 70],
                                backgroundColor: 'rgba(52, 152, 219, 0.7)'
                            },
                            {
                                label: '方案二',
                                data: [12, 16, 85, 130, 130, 99, 88, 20, 85],
                                backgroundColor: 'rgba(46, 204, 113, 0.7)'
                            }
                        ]
                    },
                    options: {
                        scales: {
                            y: {
                                beginAtZero: true,
                                title: {
                                    display: true,
                                    text: '相对值'
                                }
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: 'DEA投入产出对比'
                            }
                        }
                    }
                });
            }
            
            // 初始化综合评价图表
            function initComprehensiveChart() {
                const comprehensiveCtx = document.getElementById('comprehensiveEvaluationChart').getContext('2d');
                new Chart(comprehensiveCtx, {
                    type: 'radar',
                    data: {
                        labels: ['服务型', '经济性', '可持续性', '技术效率', '纯技术效率', '规模效率', '乘客满意度', '社会影响', '技术可行性'],
                        datasets: [
                            {
                                label: '方案一',
                                data: [85, 78, 82, 89, 92, 97, 75, 70, 88],
                                backgroundColor: 'rgba(52, 152, 219, 0.2)',
                                borderColor: 'rgba(52, 152, 219, 1)',
                                borderWidth: 1,
                                pointBackgroundColor: 'rgba(52, 152, 219, 1)'
                            },
                            {
                                label: '方案二',
                                data: [92, 85, 75, 94, 95, 99, 88, 85, 92],
                                backgroundColor: 'rgba(46, 204, 113, 0.2)',
                                borderColor: 'rgba(46, 204, 113, 1)',
                                borderWidth: 1,
                                pointBackgroundColor: 'rgba(46, 204, 113, 1)'
                            }
                        ]
                    },
                    options: {
                        scales: {
                            r: {
                                angleLines: {
                                    display: true
                                },
                                suggestedMin: 0,
                                suggestedMax: 100
                            }
                        },
                        plugins: {
                            title: {
                                display: true,
                                text: '综合评价对比',
                                font: {
                                    size: 20
                                }
                            }
                        }
                    }
                });
            }
            
            // 初始化其他图表
            function initOtherCharts() {
                const coreIndicatorChart = echarts.init(document.getElementById('coreIndicatorChart'));
                const coreIndicatorOption = {
                    title: {
                        text: '核心指标对比'
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        }
                    },
                    legend: {
                        data: ['现状', '方案一', '方案二']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01]
                    },
                    yAxis: {
                        type: 'category',
                        data: ['高峰满载率', '正点率', '高峰平均候车时间', '乘客满意度', '社会影响', '技术可行性']
                    },
                    series: [
                        {
                            name: '现状',
                            type: 'bar',
                            data: [130, 92, 9, 70, 65, 70]
                        },
                        {
                            name: '方案一',
                            type: 'bar',
                            data: [120, 98, 3, 75, 70, 75]
                        },
                        {
                            name: '方案二',
                            type: 'bar',
                            data: [120, 98, 2, 80, 75, 80]
                        }
                    ]
                };
                coreIndicatorChart.setOption(coreIndicatorOption);
                
                const speedComparisonChart = echarts.init(document.getElementById('speedComparisonChart'));
                const speedComparisonOption = {
                    title: {
                        text: '站间速度对比'
                    },
                    tooltip: {
                        trigger: 'axis',
                        axisPointer: {
                            type: 'shadow'
                        }
                    },
                    legend: {
                        data: ['现状速度', '优化后速度']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'value',
                        boundaryGap: [0, 0.01]
                    },
                    yAxis: {
                        type: 'category',
                        data: ['轨道六公里站-六公里', '六公里-二塘路', '二塘路-二塘路中段', '二塘路中段-二塘路口', '二塘路口-二塘路下口', '二塘路下口-丹龙南路']
                    },
                    series: [
                        {
                            name: '现状速度',
                            type: 'bar',
                            data: [40.2, 13.5, 6.3, 4.2, 2.7, 5.6]
                        },
                        {
                            name: '优化后速度',
                            type: 'bar',
                            data: [42, 15, 7, 5, 3, 6]
                        }
                    ]
                };
                speedComparisonChart.setOption(speedComparisonOption);
                
                const waitingTimeChart = echarts.init(document.getElementById('waitingTimeChart'));
                const waitingTimeOption = {
                    title: {
                        text: '高峰候车时间对比'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['现状', '方案一', '方案二']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: ['A1', 'B1', 'C1', 'D1', 'E1', 'F1', 'G1']
                    },
                    yAxis: {
                        type: 'value',
                        name: '候车时间(分钟)'
                    },
                    series: [
                        {
                            name: '现状',
                            type: 'line',
                            data: [9, 8, 7, 10, 12, 9, 8]
                        },
                        {
                            name: '方案一',
                            type: 'line',
                            data: [3, 3, 2, 4, 5, 3, 2]
                        },
                        {
                            name: '方案二',
                            type: 'line',
                            data: [2, 2.5, 1.5, 3.5, 4.5, 2.5, 1.5]
                        }
                    ]
                };
                waitingTimeChart.setOption(waitingTimeOption);
                
                const peakTrendChart = echarts.init(document.getElementById('peakTrendChart'));
                const peakTrendOption = {
                    title: {
                        text: '高峰时段客流密度变化趋势'
                    },
                    tooltip: {
                        trigger: 'axis'
                    },
                    legend: {
                        data: ['现状', '方案一', '方案二']
                    },
                    grid: {
                        left: '3%',
                        right: '4%',
                        bottom: '3%',
                        containLabel: true
                    },
                    xAxis: {
                        type: 'category',
                        boundaryGap: false,
                        data: ['16:00', '16:15', '16:30', '16:45', '17:00', '17:15', '17:30', '17:45', '18:00']
                    },
                    yAxis: {
                        type: 'value',
                        name: '客流密度(人)'
                    },
                    series: [
                        {
                            name: '现状',
                            type: 'line',
                            data: [15, 20, 35, 45, 50, 40, 30, 20, 15]
                        },
                        {
                            name: '方案一',
                            type: 'line',
                            data: [15, 18, 25, 30, 35, 28, 20, 15, 12]
                        },
                        {
                            name: '方案二',
                            type: 'line',
                            data: [15, 16, 22, 28, 32, 25, 18, 12, 10]
                        }
                    ]
                };
                peakTrendChart.setOption(peakTrendOption);
            }
            
            // 初始化地图
            function initMap() {
                const map = new AMap.Map('mapContainer', {
                    zoom: 12,
                    center: [106.551528, 29.563245] // 重庆市中心坐标
                });
                
                const lineSearch = new AMap.LineSearch({
                    city: '重庆'
                });
                
                lineSearch.search('334', function(status, result) {
                    if (status === 'complete' && result.info === 'OK') {
                        const lines = result.lineInfo;
                        if (lines.length > 0) {
                            const line = lines[0];
                            const path = line.path;
                            
                            const polyline = new AMap.Polyline({
                                path: path,
                                strokeColor: '#3366FF',
                                strokeWeight: 5,
                                strokeOpacity: 0.7
                            });
                            
                            polyline.setMap(map);
                            
                            // 添加起始站和终点站标记
                            const startMarker = new AMap.Marker({
                                position: path[0],
                                title: line.via_stops[0].name,
                                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/start.png'
                            });
                            
                            const endMarker = new AMap.Marker({
                                position: path[path.length - 1],
                                title: line.via_stops[line.via_stops.length - 1].name,
                                icon: 'https://webapi.amap.com/theme/v1.3/markers/n/end.png'
                            });
                            
                            startMarker.setMap(map);
                            endMarker.setMap(map);
                            
                            // 添加其他站点标记
                            line.via_stops.forEach((stop, index) => {
                                if (index > 0 && index < line.via_stops.length - 1) {
                                    const marker = new AMap.Marker({
                                        position: [stop.location.lng, stop.location.lat],
                                        title: stop.name
                                    });
                                    marker.setMap(map);
                                }
                            });
                            
                            map.setFitView([polyline]);
                        }
                    }
                });
            }
            
            // 初始化所有图表
            initOriginalCharts();
            initAhpCharts();
            initDeaCharts();
            initComprehensiveChart();
            initOtherCharts();
            initMap();
        });
    </script>
</body>
</html>
